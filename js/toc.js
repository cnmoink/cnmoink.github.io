function initTOC(){const e=document.querySelector(".post-page-container");const t=document.querySelector(".toc-content-container");if(KEEP.utils.hasToc){KEEP.utils={...KEEP.utils,findActiveIndexByTOC(){if(!Array.isArray(KEEP.utils.sections))return;let e=KEEP.utils.sections.findIndex((e=>e&&e.getBoundingClientRect().top-20>0));if(e===-1){e=KEEP.utils.sections.length-1}else if(e>0){e--}this.activateNavByIndex(e)},registerSidebarTOC(){KEEP.utils.sections=[...document.querySelectorAll(".post-toc li a.nav-link")].map((e=>{const t=document.getElementById(decodeURI(e.getAttribute("href")).replace("#",""));e.addEventListener("click",(i=>{i.preventDefault();let o=window.scrollY;o=o===0?-20:o;const n=t.getBoundingClientRect().top+o;window.anime({targets:document.scrollingElement,duration:500,easing:"linear",scrollTop:n-10,complete:()=>{history.pushState(null,document.title,e.href);setTimeout((()=>{KEEP.utils.pageTop_dom.classList.add("hide")}),150)}})}));return t}))},activateNavByIndex(e){const t=document.querySelectorAll(".post-toc li a.nav-link")[e];if(!t||t.classList.contains("active-current"))return;document.querySelectorAll(".post-toc .active").forEach((e=>{e.classList.remove("active","active-current")}));t.classList.add("active","active-current");let i=t.parentNode;while(!i.matches(".post-toc")){if(i.matches("li"))i.classList.add("active");i=i.parentNode}const o=document.querySelector(".post-toc-wrap");window.anime({targets:o,duration:200,easing:"linear",scrollTop:o.scrollTop-o.offsetHeight/2+t.getBoundingClientRect().top-o.getBoundingClientRect().top})},handleShowWhenHasToc(){const e=()=>{const e=KEEP.getStyleStatus();const t="isShowToc";if(e&&e.hasOwnProperty(t)){KEEP.utils.postHelper.hasToc(e[t])}else{KEEP.utils.postHelper.hasToc(true)}};const t="init_open";if(KEEP.theme_config.toc.hasOwnProperty(t)){KEEP.theme_config.toc[t]?e():KEEP.utils.postHelper.hasToc(false)}else{e()}}};KEEP.utils.handleShowWhenHasToc();KEEP.utils.registerSidebarTOC()}else{if(t&&e){e.removeChild(t)}}}if(KEEP.theme_config.pjax.enable===true&&KEEP.utils){initTOC()}else{window.addEventListener("DOMContentLoaded",initTOC)}